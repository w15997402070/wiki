# 装饰模式

在不修改任何底层代码的情况下,给对象赋予新的职责

Mybatis 中对装饰模式的使用 : 

定义缓存接口 Cache : 

```java
package org.apache.ibatis.cache

public interface Cache {

  String getId();

  void putObject(Object key, Object value);

  Object getObject(Object key);

  Object removeObject(Object key);
 
  void clear();

  int getSize();
  
  ReadWriteLock getReadWriteLock();

}
```

设置缓存的配置 ,一层层装饰,添加不同的功能:

```java
private Cache setStandardDecorators(Cache cache) {
    try {
      MetaObject metaCache = SystemMetaObject.forObject(cache);
      if (size != null && metaCache.hasSetter("size")) {
        metaCache.setValue("size", size);
      }
      if (clearInterval != null) {
          //添加 ScheduledCache 装饰器
        cache = new ScheduledCache(cache);
        ((ScheduledCache) cache).setClearInterval(clearInterval);
      }
      if (readWrite) {
          //添加序列化 SerializedCache 装饰器
        cache = new SerializedCache(cache);
      }
        //添加日志 LoggingCache 装饰器
      cache = new LoggingCache(cache);
        
      cache = new SynchronizedCache(cache);
      if (blocking) {
          //添加阻塞装饰器
        cache = new BlockingCache(cache);
      }
      return cache;
    } catch (Exception e) {
      throw new CacheException("Error building standard cache decorators.  Cause: " + e, e);
    }
  }
```


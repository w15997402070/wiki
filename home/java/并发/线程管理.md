# 线程基本知识

[toc]

## 线程概念

一个进程中有多个线程，多个线程共享进程的堆和方法区资源，但是每个线程有自己的程序计数器和栈区域.

程序计数器是一块内存区域，用来记录线程当前要执行的指令地址.程序计数器就是为了记录该线程让出CPU时的执行地址的，待再次分配到时间片时线程就可以从自己私有的计数器指定地址继续执行

每个线程都有自己的栈资源，用于存储该线程的局部变量，这些局部变量是该线程私有的，其他线程是访问不了的，除此之外栈还用来存放线程的调用栈帧。

堆是一个进程中最大的一块内存，堆是被进程中的所有线程共享的，是进程创建时分配的，堆里面主要存放使用new操作创建的对象实例。

方法区则用来存放JVM加载的类、常量及静态变量等信息，也是线程共享的。

## 创建线程的方式

1. 继承Thread类,重新创写run方法会

2. 实现Runnable接口

3. FutureTask方式

    ```java
    public class FutureTaskDemo {
    
        static class CallerTask implements Callable<String> {
    
            @Override
            public String call() throws Exception {
                return "callable";
            }
        }
    
        public static void main(String[] args) {
            FutureTask<String> futureTask = new FutureTask<>(new CallerTask());
            Thread thread = new Thread(futureTask);
            thread.start();
            try {
                String result = futureTask.get();
                System.out.println(result);
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        }
    }
    ```

    

    使用继承方式的好处是方便传参，你可以在子类里面添加成员变量，通过set方法设置参数或者通过构造函数进行传递，而如果使用Runnable方式，则只能使用主线程里面被声明为final的变量。不好的地方是Java不支持多继承，如果继承了Thread类，那么子类不能再继承其他类，而Runable则没有这个限制。前两种方式都没办法拿到任务的返回结果，但是Futuretask方式可以。

## 线程优先级

每个线程都有优先级,范围在`Thread. MIN_PRIORITY`和`MAX_PRIORITY`之间(1到10之间),默认优先级为5

```java
public final static int MIN_PRIORITY = 1;
public final static int NORM_PRIORITY = 5;
public final static int MAX_PRIORITY = 10;
```

优先级范围 : 

```
10 -> 关键问题
7~9 -> 交互事件驱动
4~6 -> IO相关
2~3 -> 后台计算
1 -> 在没有其他程序运行的情况下运行
```


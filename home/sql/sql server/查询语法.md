# 查询语法

## select语句的查询语法

```sql
SELECT [All | Distinct] select_list 
[ INTO new_table]   -- 用来创建一个新的表,表的数据为查询的结果集
FROM table_source
[WHERE search_conditions]
[GROUP BY group_by_expression]
[HAVING search_conditions]
[ORDER BY order_expression [ASC | DESC]]
```

## SELECT 语句的查询顺序

1. FROM 子句
2. WHERE 子句(可选)
3. GROUP BY 子句(可选)
4. HAVING 子句(可选)
5. SELECT 子句
6. ORDER BY 子句(可选)

## 插入语句

### 简单的insert语句

```sql
INSERT [INTO] table_or_view [column_list] VALUES (data_values)
```

###  insert ... select 语句

```sql
INSERT table_name
SELECT column_list
FROM table_list
WHERE search_conditions
```

## 更新语句

```sql
UPDATE [TOP] table_or_view 
SET {column_name = expression | DEFAULT | NULL}[...n]
[WHERE search_conditions]
```

### 根据其他表更新行

```sql
UPDATE table_or_view
SET [column_name = expression | DEFAULT | NULL][...n]
[FROM table_source]
[WHERE search_conditions]
```

## 删除语句

```sql
DELETE table_or_view
FROM table_sources
WHERE search_conditons
```

### 删除基于其它表中的行

```sql
-- 该句删除table_source中满足条件的行
DELETE FROM table_source 
FROM table_name n
INNER JOIN table_source s ON n.condition = s.condition WHERE delete_conditions
```



## TRUNCATE TABLE 语句

```sql
TRUNCATE TABLE [[database.]owner.]table_name
```



## top关键字

   ### 语法格式

```sql
SELECT [TOP n] [columns] FROM table
```

`TOP` 表达式可以指定要更新的行数或行数的百分比.`TOP`表达式可用在`SELECT`,`INSERT`,`UPDATE`,`DELETE`语句中,基本语法如下 : 

```sql
TOP (expression) [PERCENT] [WITH TIES]
```

`expression`指定返回行数的数值表达式,如果指定了PERCENT,则expression将隐式转化为float,否则转换为bigint.

`PERCENT` 指示查询只返回结果集中前expression%的行